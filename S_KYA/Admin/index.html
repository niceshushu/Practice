<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <link href="script/easyui/themes/gray/easyui.css" rel="stylesheet" />
    <link href="script/easyui/themes/icon.css" rel="stylesheet" />
    <!--<script src="script/easyui/jquery.min.js"></script>-->
    <script src="script/jquery-3.3.1.js"></script>
    <script src="script/easyui/jquery.easyui.min.js"></script>
    <style>
        #accordion1 ul {
            margin: 0px;
            /*添加padding可以解决居中问题*/
            padding: 10px;
        }

        #accordion1 li {
            list-style: none;
            padding: 5px;
        }

        .selected {
            border: 1px solid #D69C00;
            background-color: #FFE88C;
            cursor: default;
        }
    </style>
</head>
<body class="easyui-layout">
    <!--顶部Begin-->
    <div data-options="region:'north',border:false" style="height:60px;background:#B3DFDA;padding:10px;">
        <span style="font-size:32px;">可有爱后台管理</span>
        <div style="position:absolute; right:5px;top:10px;" id="div_welcome">
        </div>

        <div style="position: absolute; right: 0px; bottom: 0px;">
            <a href="javascript:void(0);" class="easyui-linkbutton" data-options="plain:true,iconCls:'icon-boss'" onclick="searchMyInfo();">我的信息</a>
            <a href="javascript:void(0);" class="easyui-linkbutton" data-options="plain:true,iconCls:'icon-set1'" onclick="changePwd();">修改密码</a>
            <a href="javascript:void(0);" class="easyui-linkbutton" data-options="plain:true,iconCls:'icon-stop'" onclick="loginOut();">退出系统</a>
        </div>
    </div>
    <!--顶部End-->
    <!--右侧导航栏Begin-->
    <div data-options="region:'west',split:true,title:'功能导航'" style="width:200px;">
        <div id="accordion1" class="easyui-accordion" fit="true" border="false">
            <div title="系统设置" iconcls="icon-cog" style="padding:10px;">

            </div>
            <ul id="tt2"></ul>
        </div>

    
    </div>
    <!--右侧导航栏End-->
    <!--中间部分Begin-->
    <div data-options="region:'center'">
        <!--不+title属性tab页就会自动上调-->
        <div id="tt" class="easyui-tabs" data-options="fit:'true'">

            <div data-options="closable:'true'" style="padding:20px;display:none;">
                动态tab页面
            </div>
            <div title="首页2" data-options="closable:'true'" style="padding:20px;display:none;">
                动态tab页面2
            </div>

            <div title="首页3" data-options="closable:'true'" style="padding:20px;display:none;">
                动态tab页面3
            </div>

        </div>

    </div>
    <!--中间部分End-->

    <script type="text/javascript">
        $("#tt").tabs({
            tools: [{
                iconCls: 'icon-arrow_refresh',
                text: "刷新",
                handler: function () {

                }
            }, {
                iconCls: 'icon-delete3',
                text: "关闭全部",
                handler: function () {

                }
            }]
        });
        $('#tt2').tree({
            data: [
                {
                    "id": "COMMON_NULL",
                    "text": "参数管理",
                    "state": "closed",
                    "children": [
                        {
                            "id": "/ParameterManagement/Cus/PARA_TABLE_CUS/List.aspx",
                            "text": "业务参数库设置"
                        },
                        {
                            "id": "/ParameterManagement/Cus/COD_CUS_CUSTOMCODE/List.aspx",
                            "text": "海关参数库"
                        },
                        {
                            "id": "/ParameterManagement/Cus/EXCHANGE_RATE/List.aspx",
                            "text": "汇率维护"
                        },
                        {
                            "id": "/ParameterManagement/Cus/COD_AREAS/List.aspx",
                            "text": "监管场所码维护"
                        }
                    ]
                },
                {
                    "id": "COMMON_NULL",
                    "text": "企业备案管理",
                    "state": "closed",
                    "children": [
                        {
                            "id": "/BusinessManagement/Cus/KJ_COURIER_COMPANIES_DATA/List.aspx",
                            "text": "电商接入企业资料管理"
                        },
                        {
                            "id": "/BusinessManagement/Cus/KJ_COURIER_COMPANIES_DATA/List.aspx?isView=1",
                            "text": "电商接入企业资料查询"
                        },
                        {
                            "id": "/BusinessManagement/Cus/KJ_ENT_DATA_APPLI/List.aspx",
                            "text": "电商企业备案申请审核"
                        },
                        {
                            "id": "/BusinessManagement/Cus/KJ_ENT_DATA_APPLI/List.aspx?isView=1",
                            "text": "电商企业备案申请查询"
                        },
                        {
                            "id": "/BusinessManagement/Cus/KJ_ENT_DATA_RECORD/List.aspx",
                            "text": "电商企业备案资料管理"
                        },
                        {
                            "id": "/BusinessManagement/Cus/KJ_ENT_DATA_RECORD/List.aspx?isView=1",
                            "text": "电商企业备案资料查询"
                        }
                    ]
                },
                {
                    "id": "COMMON_NULL",
                    "text": "商品备案管理",
                    "state": "closed",
                    "children": [
                        {
                            "id": "/BusinessManagement/Cus/KJ_GOODS_DATA_APPLY/List.aspx",
                            "text": "电商企业商品备案申请审核"
                        },
                        {
                            "id": "COMMON_NULL",
                            "text": "电商企业商品备案申请查询",
                            "state": "closed",
                            "children": [
                                {
                                    "id": "COMMON_NULL",
                                    "text": "测试"
                                }
                            ]

                        },
                        {
                            "id": "COMMON_NULL",
                            "text": "电商企业备案商品管理"
                        },
                        {
                            "id": "COMMON_NULL",
                            "text": "电商企业备案商品查询"
                        }
                    ]
                },
                {
                    "id": "COMMON_NULL",
                    "text": "清单管理",
                    "state": "closed",
                    "children": [
                        {
                            "id": "/BusinessManagement/Cus/KJ_CROSS_BORDER_E_HEAD/List.aspx?isAudit=1",
                            "text": "电商出境货物清单审核"
                        },
                        {
                            "id": "/BusinessManagement/Cus/KJ_CROSS_BORDER_E_HEAD/List.aspx?isManage=1",
                            "text": "电商出境货物清单管理"
                        },
                        {
                            "id": "/BusinessManagement/Cus/KJ_CROSS_BORDER_E_HEAD/List.aspx?isView=1",
                            "text": "电商出境货物清单查询"
                        }
                    ]
                },
                {
                    "id": "COMMON_NULL",
                    "text": "清单汇总",
                    "state": "closed",
                    "children": [
                        {
                            "id": "COMMON_NULL",
                            "text": "电商企业清单汇总定制条件查询"
                        },
                        {
                            "id": "COMMON_NULL",
                            "text": "电商出境货物清单汇总查询"
                        }
                    ]
                },
                {
                    "id": "COMMON_NULL",
                    "text": "统计查询",
                    "state": "closed",
                    "children": [
                        {
                            "id": "COMMON_NULL",
                            "text": "企业备案信息统计"
                        },
                        {
                            "id": "COMMON_NULL",
                            "text": "商品备案信息统计"
                        },
                        {
                            "id": "COMMON_NULL",
                            "text": "清单信息统计"
                        },
                        {
                            "id": "COMMON_NULL",
                            "text": "汇总清单统计"
                        }
                    ]
                },
                {
                    "id": "COMMON_NULL",
                    "text": "系统管理",
                    "state": "closed",
                    "children": [
                        {
                            "id": "/sys/sys_Role/List.aspx",
                            "text": "角色管理"
                        },
                        {
                            "id": "/sys/sys_User/List.aspx",
                            "text": "用户管理"
                        },
                        {
                            "id": "/sys/sys_Param/List.aspx",
                            "text": "参数维护"
                        },
                        {
                            "id": "/sys/funcMenu/menuFrame.aspx",
                            "text": "菜单管理"
                        }
                    ]
                }
            ]
        });



        function addTab(title, url, icon) {
            console.log(title);
            console.log(url);
            console.log(icon);
            if (url == "" || url == "#") {
                return false;
            }
            console.log($("#tt").tabs("tabs").length);//当前面板的个数
            var ttCount = $("#tt").tabs("tabs").length;
            var hasTab = $('#tt').tabs('exists', title);
            var add = function () {
                if (!hasTab) {
                    $('#tt').tabs('add', {
                        title: title,
                        content: createFrame(url),
                        closable: true,
                        icon: icon
                    });
                }
                else {
                    $('#tt').tabs('select', title)
                }
            }

            if (ttCount >= 5 && !hasTab) {
                var msg = '<b>您当前打开了太多的页面，如果继续打开，会造成程序运行缓慢，无法流畅操作！</b>';
                $.messager.confirm("系统提示", msg, function (b) {
                    if (b) add();
                    else return false;
                });
            } else {
                add();
            }
        }
        function createFrame(url) {
            var s = '<frame scrolling="auto" frameborder="0" style="width:100%;height:100%" src="' + url + '"></iframe>';
            return s;
        }

        $(function () {
            // $.on() &.live()
            $('.menuItem li').on({
                click: function () {
                    //应为是最外层的li点击，所以他的子节点一定是固定的
                    var a = $(this).children('div').children('a');
                    var title = $(a).children('.nav').text();
                    var url = $(a).attr("rel");
                    var icon = $(a).children(".icon").attr("class");
                    addTab(title, url, icon);

                    $('.accordion li div').removeClass("selected");
                    $(this).children('div').addClass("selected");
                }
            });
        });
    </script>
</body>
</html>
